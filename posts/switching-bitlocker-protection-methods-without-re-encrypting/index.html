<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
        <title>Switching BitLocker protection methods without re-encrypting - stevenmaude.co.uk</title><meta name="description" content="Steven Maude&#39;s blog"><meta property="og:title" content="Switching BitLocker protection methods without re-encrypting" />
<meta property="og:description" content="How to change BitLocker key protectors without having to" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.stevenmaude.co.uk/posts/switching-bitlocker-protection-methods-without-re-encrypting/" /><meta property="og:image" content="https://www.stevenmaude.co.uk/logo.png"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2017-02-04T17:54:00+00:00" />
<meta property="article:modified_time" content="2017-02-04T17:54:00+00:00" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://www.stevenmaude.co.uk/logo.png"/>

<meta name="twitter:title" content="Switching BitLocker protection methods without re-encrypting"/>
<meta name="twitter:description" content="How to change BitLocker key protectors without having to"/>
<meta name="application-name" content="Steven Maude">
<meta name="apple-mobile-web-app-title" content="Steven Maude"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://www.stevenmaude.co.uk/posts/switching-bitlocker-protection-methods-without-re-encrypting/" /><link rel="prev" href="https://www.stevenmaude.co.uk/posts/blocking-urls-in-emails-from-being-opened-in-thunderbird/" /><link rel="next" href="https://www.stevenmaude.co.uk/posts/the-dangers-of-long-forgotten-bitbucket-team-accounts/" /><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/normalize.css@8.0.1/normalize.min.css"><link rel="stylesheet" href="/css/style.min.935c5813d5461a54113f4388bd97dd5fac3dca09573e2e89f8d860d52282ec38.css" integrity="sha256-k1xYE9VGGlQRP0OIvZfdX6w9yglXPi6J&#43;Nhg1SKC7Dg="><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.13.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.7.2/animate.min.css"><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Switching BitLocker protection methods without re-encrypting",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/www.stevenmaude.co.uk\/posts\/switching-bitlocker-protection-methods-without-re-encrypting\/"
        },"image": ["https:\/\/www.stevenmaude.co.uk\/images\/Apple-Devices-Preview.png"],"genre": "posts","keywords": "BitLocker, manage-bde","wordcount":  614 ,
        "url": "https:\/\/www.stevenmaude.co.uk\/posts\/switching-bitlocker-protection-methods-without-re-encrypting\/","datePublished": "2017-02-04T17:54:00+00:00","dateModified": "2017-02-04T17:54:00+00:00","publisher": {
            "@type": "Organization",
            "name": "xxxx","logo": "https:\/\/www.stevenmaude.co.uk\/images\/avatar.png"},"author": {
                "@type": "Person",
                "name": "Steven Maude"
            },"description": ""
    }
    </script></head>
    <body header-desktop="fixed" header-mobile="auto"><script type="text/javascript">('false' === 'true' && window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="stevenmaude.co.uk"><span class="header-title-pre"><i class='fas fa-laptop-code fa-fw'></i></span>stevenmaude.co.uk</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> Posts </a><a class="menu-item" href="/tags/"> Tags </a><a class="menu-item" href="/categories/"> Categories </a><a class="menu-item" href="/about/"> About </a><a class="menu-item" href="https://github.com/StevenMaude" title="GitHub" rel="noopener noreferrer" target="_blank"><i class='fab fa-github fa-fw'></i>  </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Search">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Clear">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="stevenmaude.co.uk"><span class="header-title-pre"><i class='fas fa-laptop-code fa-fw'></i></span>stevenmaude.co.uk</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Search">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Clear">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        Cancel
                    </a>
                </div><a class="menu-item" href="/posts/" title="">Posts</a><a class="menu-item" href="/tags/" title="">Tags</a><a class="menu-item" href="/categories/" title="">Categories</a><a class="menu-item" href="/about/" title="">About</a><a class="menu-item" href="https://github.com/StevenMaude" title="GitHub" rel="noopener noreferrer" target="_blank"><i class='fab fa-github fa-fw'></i></a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw"></i>
            </a></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div>
<main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title flipInX">Switching BitLocker protection methods without re-encrypting</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="/" title="Author" rel=" author" class="author"><i class="fas fa-user-circle fa-fw"></i>Steven Maude</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="2017-02-04">2017-02-04</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;614 words&nbsp;
                <i class="far fa-clock fa-fw"></i>&nbsp;3 minutes&nbsp;</div>
        </div><div class="details toc" id="toc-static"  kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#overzealous-tpm-protection">Overzealous TPM protection</a></li>
    <li><a href="#fixing-the-tpm">Fixing the TPM</a></li>
    <li><a href="#using-manage-bde-to-change-key-protection-methods">Using manage-bde to change key protection methods</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><pre><code>     decrypt and re-encrypt a drive.
</code></pre>
<h2 id="overzealous-tpm-protection">Overzealous TPM protection</h2>
<p>I&rsquo;d set up BitLocker for someone using the Trusted Platform Module (TPM)
in their laptop with a PIN<sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup> to decrypt the drive. Unfortunately, they
found that, after some time, the system tended to lock the PIN out,
unless they used a recovery key to bypass the TPM and PIN access
altogether.</p>
<p>As far as I can tell, this is some feature of the TPM in this particular
laptop where too many incorrectly entered passwords results in the TPM
locking out for some lengthy and possibly indefinite amount of time.
Perhaps even permanently. I don&rsquo;t think this is the case where incorrect
passwords are continually entered in a short time period, but where
incorrect attempts over a longer period are cumulatively logged.</p>
<p>In this case, this state doesn&rsquo;t seem to get reset even if you
subsequently re-enter the correct password, or unlock with another
method. (It seems reasonable that the TPM&rsquo;s unaware of whether
BitLocker&rsquo;s been unlocked or not by other means.)</p>
<h2 id="fixing-the-tpm">Fixing the TPM</h2>
<p>You can rectify this by <a href="https://technet.microsoft.com/en-us/library/dd851452%28v=ws.11%29.aspx" target="_blank" rel="noopener noreferrer">resetting the TPM
lockout</a>
but this is only a temporary fix. Again, after some number of password
failures the lockout may happen again. My conclusion in this case is
that, although disabling the TPM makes the system slightly less secure,
the greatest threat here is not an unauthorised user accessing the data,
but an authorised user being unable to access the data. Switching to
just a password unlock then seems more sensible. I wouldn&rsquo;t recommend
this downgrade in security otherwise.</p>
<p>At first look, you might think that this is a chore to switch. There&rsquo;s
no obvious way of doing this in the BitLocker options for the drive, or
under Control Panel, and your instinct might be to decrypt the drive and
encrypt again. That can be time consuming, especially with large drives.</p>
<h2 id="using-manage-bde-to-change-key-protection-methods">Using manage-bde to change key protection methods</h2>
<p>Instead, you can run the command line utility:
<a href="https://technet.microsoft.com/en-us/library/ff829848%28v=ws.10%29.aspx" target="_blank" rel="noopener noreferrer">manage-bde</a>.</p>
<p>Since TPM plus PIN, or recovery key (or some other method of securing
your BitLocker encryption key) are key protection methods, Microsoft
terms them &ldquo;protectors&rdquo;. Also, here we are looking at removing a TPM and
PIN protector, but you can use manage-bde to handle any BitLocker
protector.</p>
<p>Specifically, you want to remove the existing TPM and PIN protector:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">manage-bde -protectors -delete &lt;Drive&gt; -tpmandpin
</code></pre></div><p>You have to do this first, as it&rsquo;s not possible to have both TPM and PIN
protector, and a password protector.</p>
<p>(A caution that <code>-delete</code> without specifying <code>-type</code> removes all
protectors and then will disable protection, so that you can still
access your drive in future. If you do that, you&rsquo;ll need to add new
protectors, as below, and you&rsquo;ll need to add new recovery protectors,
should you wish. You can do by specifying <code>-recoverypassword</code> for a
numerical recovery code, or <code>-recoverykey</code> for an external key in the
<code>-add</code> command below. And then you must enable the protectors again with
<code>manage-bde -protectors -enable</code>, including new recovery keys should you
wish to have them.)</p>
<p>Next, add a new protector, e.g. a password:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">manage-bde -protectors -add &lt;Drive&gt; -password
</code></pre></div><p>(<code>C:</code> is the most likely <code>&lt;Drive&gt;</code> value here.)</p>
<p>You&rsquo;ll be prompted to enter, and then confirm, the new password. Now,
you&rsquo;ll have a password protector, which won&rsquo;t be subject to a TPM
lockout, as we wanted.</p>
<p>Finally, you can also check BitLocker status:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">manage-bde -protectors -status
</code></pre></div><p>to confirm that the drive is encrypted, and which key protectors are
active.</p>
<section class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1" role="doc-endnote">
<p>Well, password. You can configure Group Policy to allow passwords
with TPM, instead of just numerical PINs. Microsoft&rsquo;s documentation
always refers to this option as &ldquo;TPM and PIN&rdquo; regardless. This doesn&rsquo;t
change the BitLocker prompt: it still asks for a PIN.&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</section>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2017-02-04</span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md"><span>
                            <a class="link-to-markdown" href="/posts/switching-bitlocker-protection-methods-without-re-encrypting/index.md" target="_blank" rel="noopener noreferrer">Read Markdown</a>
                        </span></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Share on Twitter" data-sharer="twitter" data-url="https://www.stevenmaude.co.uk/posts/switching-bitlocker-protection-methods-without-re-encrypting/" data-title="Switching BitLocker protection methods without re-encrypting" data-hashtags="BitLocker,manage-bde"><i class="fab fa-twitter fa-fw"></i></a><a href="javascript:void(0);" title="Share on Facebook" data-sharer="facebook" data-url="https://www.stevenmaude.co.uk/posts/switching-bitlocker-protection-methods-without-re-encrypting/" data-hashtag="BitLocker"><i class="fab fa-facebook-square fa-fw"></i></a><a href="javascript:void(0);" title="Share on Hacker News" data-sharer="hackernews" data-url="https://www.stevenmaude.co.uk/posts/switching-bitlocker-protection-methods-without-re-encrypting/" data-title="Switching BitLocker protection methods without re-encrypting"><i class="fab fa-hacker-news fa-fw"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw"></i>&nbsp;<a href="/tags/bitlocker/">Bitlocker</a>,&nbsp;<a href="/tags/manage-bde/">manage-bde</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/posts/blocking-urls-in-emails-from-being-opened-in-thunderbird/" class="prev" rel="prev" title="Blocking URLs in emails from being opened in Thunderbird "><i class="fas fa-angle-left fa-fw"></i>Blocking URLs in emails from being opened in Thunderbird </a>
            <a href="/posts/the-dangers-of-long-forgotten-bitbucket-team-accounts/" class="next" rel="next" title="The dangers of long forgotten Bitbucket team accounts">The dangers of long forgotten Bitbucket team accounts<i class="fas fa-angle-right fa-fw"></i></a></div>
</div>
<div id="comments"></div></article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener noreferrer" title="Hugo 0.91.2">Hugo</a> | Theme - <a href="https://github.com/sunt-programator/CodeIT" target="_blank" rel="noopener noreferrer" title="CodeIT 0.2.10"><i class="fas fa-laptop-code fa-fw"></i> CodeIT</a>
                </div><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2013 - 2022</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/" target="_blank" rel="noopener noreferrer">Steven Maude</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw"></i>
            </a>
        </div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/smooth-scroll@16.1.3/dist/smooth-scroll.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/autocomplete.js@0.37.1/dist/autocomplete.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lunr@2.3.8/lunr.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lazysizes@5.2.2/lazysizes.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/clipboard@2.0.6/dist/clipboard.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/sharer.js@0.4.0/sharer.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":10},"comment":{},"search":{"highlightTag":"em","lunrIndexURL":"/index.json","maxResultLength":10,"noResultsFound":"No results found","snippetLength":30,"type":"lunr"}};</script><script type="text/javascript" src="/js/theme.min.47a1ff73dc443ed4a9f13e3134f6058e8c6d21248b35d03e7d64f56345190c3e.js" integrity="sha256-R6H/c9xEPtSp8T4xNPYFjoxtISSLNdA&#43;fWT1Y0UZDD4="></script></body>
</html>
