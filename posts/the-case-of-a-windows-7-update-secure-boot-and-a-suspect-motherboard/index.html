<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
        <title>The case of a Windows 7 update, Secure Boot and a suspect motherboard  - stevenmaude.co.uk</title><meta name="description" content="Steven Maude&#39;s blog"><meta property="og:title" content="The case of a Windows 7 update, Secure Boot and a suspect motherboard " />
<meta property="og:description" content="Fixing Secure Boot related issues on Windows 7 following the KB3133977 update." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.stevenmaude.co.uk/posts/the-case-of-a-windows-7-update-secure-boot-and-a-suspect-motherboard/" /><meta property="og:image" content="https://www.stevenmaude.co.uk/logo.png"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2016-04-12T00:33:00+00:00" />
<meta property="article:modified_time" content="2016-09-17T12:40:00+00:00" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://www.stevenmaude.co.uk/logo.png"/>

<meta name="twitter:title" content="The case of a Windows 7 update, Secure Boot and a suspect motherboard "/>
<meta name="twitter:description" content="Fixing Secure Boot related issues on Windows 7 following the KB3133977 update."/>
<meta name="application-name" content="Steven Maude">
<meta name="apple-mobile-web-app-title" content="Steven Maude"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://www.stevenmaude.co.uk/posts/the-case-of-a-windows-7-update-secure-boot-and-a-suspect-motherboard/" /><link rel="prev" href="https://www.stevenmaude.co.uk/posts/firefox-keyword-searches-and-how-to-fix-adding-them/" /><link rel="next" href="https://www.stevenmaude.co.uk/posts/managing-a-bitbucket-users-permissions-when-theyve-left-your-team/" /><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/normalize.css@8.0.1/normalize.min.css"><link rel="stylesheet" href="/css/style.min.935c5813d5461a54113f4388bd97dd5fac3dca09573e2e89f8d860d52282ec38.css" integrity="sha256-k1xYE9VGGlQRP0OIvZfdX6w9yglXPi6J&#43;Nhg1SKC7Dg="><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.13.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.7.2/animate.min.css"><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "The case of a Windows 7 update, Secure Boot and a suspect motherboard ",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/www.stevenmaude.co.uk\/posts\/the-case-of-a-windows-7-update-secure-boot-and-a-suspect-motherboard\/"
        },"image": ["https:\/\/www.stevenmaude.co.uk\/images\/Apple-Devices-Preview.png"],"genre": "posts","keywords": "Windows, Secure Boot","wordcount":  999 ,
        "url": "https:\/\/www.stevenmaude.co.uk\/posts\/the-case-of-a-windows-7-update-secure-boot-and-a-suspect-motherboard\/","datePublished": "2016-04-12T00:33:00+00:00","dateModified": "2016-09-17T12:40:00+00:00","publisher": {
            "@type": "Organization",
            "name": "xxxx","logo": "https:\/\/www.stevenmaude.co.uk\/images\/avatar.png"},"author": {
                "@type": "Person",
                "name": "Steven Maude"
            },"description": ""
    }
    </script></head>
    <body header-desktop="fixed" header-mobile="auto"><script type="text/javascript">('false' === 'true' && window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="stevenmaude.co.uk"><span class="header-title-pre"><i class='fas fa-laptop-code fa-fw'></i></span>stevenmaude.co.uk</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> Posts </a><a class="menu-item" href="/tags/"> Tags </a><a class="menu-item" href="/categories/"> Categories </a><a class="menu-item" href="/about/"> About </a><a class="menu-item" href="https://github.com/StevenMaude" title="GitHub" rel="noopener noreferrer" target="_blank"><i class='fab fa-github fa-fw'></i>  </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Search">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Clear">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="stevenmaude.co.uk"><span class="header-title-pre"><i class='fas fa-laptop-code fa-fw'></i></span>stevenmaude.co.uk</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Search">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Clear">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        Cancel
                    </a>
                </div><a class="menu-item" href="/posts/" title="">Posts</a><a class="menu-item" href="/tags/" title="">Tags</a><a class="menu-item" href="/categories/" title="">Categories</a><a class="menu-item" href="/about/" title="">About</a><a class="menu-item" href="https://github.com/StevenMaude" title="GitHub" rel="noopener noreferrer" target="_blank"><i class='fab fa-github fa-fw'></i></a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw"></i>
            </a></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div>
<main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title flipInX">The case of a Windows 7 update, Secure Boot and a suspect motherboard </h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="/" title="Author" rel=" author" class="author"><i class="fas fa-user-circle fa-fw"></i>Steven Maude</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="2016-04-12">2016-04-12</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;999 words&nbsp;
                <i class="far fa-clock fa-fw"></i>&nbsp;5 minutes&nbsp;</div>
        </div><div class="details toc" id="toc-static"  kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#a-stubborn-pc">A stubborn PC</a></li>
    <li><a href="#asuspect">ASUSpect?</a></li>
    <li><a href="#what-to-do">What to do?</a></li>
    <li><a href="#one-more-thing">One more thing</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><p>Because, obviously, I have nothing I&rsquo;d rather do than try to fathom how Secure
Boot works on a Monday evening, I&rsquo;m writing this up.</p>
<p>Maybe you&rsquo;re experiencing this problem right now. Maybe you&rsquo;re not, but you&rsquo;re
intrigued as to how I go about diagnosing computer problems.</p>
<h2 id="a-stubborn-pc">A stubborn PC</h2>
<p>I maintain a PC that has Windows 7 installed (due to be upgraded to Windows 10)
and, yesterday evening, installed several optional updates.<sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup> Nothing unusual
there.</p>
<p>A day later, an owner of the machine restarted it. Except, well, the PC
refused.</p>
<p>Instead it said this:</p>
<blockquote>
<p>The system found unauthorized changes on the firmware, operating system or
UEFI drivers.</p>
</blockquote>
<p>Hmm. That&rsquo;s certainly not good since it&rsquo;s related to <a href="https://technet.microsoft.com/en-GB/library/hh824987.aspx" target="_blank" rel="noopener noreferrer">Secure
Boot</a>&rsquo;s check of
boot integrity. Warily, I disabled Secure Boot in the BIOS to get the machine
to boot Windows, and checked the System Event Log.</p>
<p>Looking around the log, it turns out that the last time that the machine had
previously successfully started was just before I installed the updates, which
is consistent with what had happened. As the PC was fine until that point, it
ruled out anything malicious, and pointed to the update as being a likely
candidate.</p>
<p>Having looked through the list of recently installed updates, most of them
seemed fairly routine, except <a href="https://support.microsoft.com/en-gb/kb/3133977" target="_blank" rel="noopener noreferrer">the KB3133977 update for a Bitlocker
issue</a>. What stood out were the
changes to Windows Boot Manager files <code>Bootmgr.efi</code> and <code>Bootmgfw.efi</code>, which
also suggested the update was at fault.</p>
<h2 id="asuspect">ASUSpect?</h2>
<p>Searching around led me to several recent links, as I mentioned in comments on
this <a href="https://superuser.com/questions/1054790/system-found-unauthorized-changes-on-the-firmware" target="_blank" rel="noopener noreferrer">SuperUser
question</a>.</p>
<p>In those posts, Windows users were reporting the same issue: the BIOS
complaining that there was an unauthorised change. This being a relatively new
issue isn&rsquo;t surprising as the update was only released on March 14th, 2016.</p>
<p>ASUS being the motherboard manufacturer seems to be common to those
experiencing the problem. It seems to affect different models; here it&rsquo;s a
H87-PRO. Even then it&rsquo;s unclear what the root cause is:</p>
<ul>
<li>
<p>maybe ASUS motherboards are the only ones that allow you to enable Secure
Boot with Windows 7?</p>
</li>
<li>
<p>maybe there&rsquo;s something unusual with the signing process of this update that
only affected ASUS motherboards?</p>
</li>
<li>
<p>or maybe it&rsquo;s just a coincidence? (But, it&rsquo;s odd that it&rsquo;s a common link in
several cases. You&rsquo;d think if users with other motherboards would have been
affected, they&rsquo;d have mentioned it too.)</p>
</li>
</ul>
<p>As linked above, Microsoft&rsquo;s site suggests Secure Boot is supported on Windows
8 and up, and I can&rsquo;t find any documentation to suggest Secure Boot should work
on Windows 7. It&rsquo;s possible that this is just behaviour out of specification
that didn&rsquo;t cause any problem until now.</p>
<p>!!! article-edit &quot;&quot;
Edit 2016-05-15: It turns out that it was a bad configuration on the
part of ASUS as documented by their
<a href="https://www.asus.com/support/faq/1016356/" target="_blank" rel="noopener noreferrer">FAQ</a>. Judging from the
news stories published around 4th May 2016 and onwards, that note
has only been released by ASUS this month. Pretty slow response,
really, seeing as this problem&rsquo;s been known for several weeks. Their
fix is one of those already suggested here: disable Secure Boot.</p>
<p>(It&rsquo;s a while ago since I installed the PC, but I guess that I originally must
have tried turning on Secure Boot during installation and, since the PC booted
without a problem, left it enabled.)</p>
<h2 id="what-to-do">What to do?</h2>
<p>Other posts I&rsquo;d read indicated that removing KB3133977 didn&rsquo;t solve this.
Perhaps there are EFI changes that don&rsquo;t get reverted when you uninstall the
update? Who knows?</p>
<p>However, restoring a previous system backup fixes the issue. You could then
leave everything as is, but have to make sure that you don&rsquo;t install this
update (hiding it would work). This is inconvenient then, but fine provided you
have regular backups.</p>
<p>Oh, but the update might actually fix a problem you&rsquo;re experiencing with
Bitlocker. In which case, you&rsquo;re going to have to install it regardless then,
aren&rsquo;t you?</p>
<p>Another solution is to disable Secure Boot in the BIOS. That&rsquo;s not a perfect
solution though, especially if you&rsquo;re booting other operating systems that work
with Secure Boot.</p>
<p>It&rsquo;s always possible, but unlikely, that Microsoft could reissue the update and
enabling the Secure Boot option might be possible again.</p>
<p>None of that explains completely what happened, but that&rsquo;s at least enough to
hopefully stop you panicking and make your Windows install accessible, if
you&rsquo;ve been affected.</p>
<p>What fun will today&rsquo;s later batch of updates brings, I wonder?</p>
<p>!!! article-edit &quot;&quot;
Edit 2016-05-20: Marc-Andre Renaud kindly emailed me to share his
experience:</p>
<pre><code>&gt; Your hunch about deleting keys while booting in UEFI mode possibly
&gt; fixing this was correct. I deleted the keys on my ASUS Sabertooth
&gt; z97 motherboard and was able to boot.
</code></pre>
<h2 id="one-more-thing">One more thing</h2>
<p>Incidentally, I wondered what happens if you disable Secure Boot, then do an
in-place upgrade of Windows in this situation, where we can&rsquo;t enable Secure
Boot? Can you later enable it?</p>
<p>My hunch is that you should be able to, provided your operating system was
installed when your BIOS was in UEFI mode. With the ASUS motherboard I was
looking at, if you were doing an in-place upgrade in this particularly strange
case, I think you&rsquo;d need to clear the Secure Boot keys to disable Secure Boot
while allowing UEFI (otherwise you wouldn&rsquo;t be able to boot Windows 7).</p>
<p>Once the upgrade&rsquo;s complete, I&rsquo;d then expect I could go back to the BIOS and
install the default Secure Boot keys, which should let you set Secure Boot
again.</p>
<p>!!! article-edit &quot;&quot;
Edit September 2016: Having tested this on a PC with this exact problem,
the answer is yes, this works fine. This Windows 7 was installed in UEFI
mode, had Secure Boot enabled until this ASUS problem occurred earlier this
year, and was then upgraded to Windows 10 with Secure Boot disabled.
Enabling Secure Boot after the upgrade was successful.</p>
<section class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1" role="doc-endnote">
<p>Previously, I had recommended updates set to automatically install, but
unfortunately it&rsquo;s now necessary to make sure you don&rsquo;t <a href="https://blogs.windows.com/windowsexperience/2015/10/29/making-it-easier-to-upgrade-to-windows-10/" target="_blank" rel="noopener noreferrer">inadvertently install
Windows 10</a>.&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</section>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2016-09-17</span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md"><span>
                            <a class="link-to-markdown" href="/posts/the-case-of-a-windows-7-update-secure-boot-and-a-suspect-motherboard/index.md" target="_blank" rel="noopener noreferrer">Read Markdown</a>
                        </span></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Share on Twitter" data-sharer="twitter" data-url="https://www.stevenmaude.co.uk/posts/the-case-of-a-windows-7-update-secure-boot-and-a-suspect-motherboard/" data-title="The case of a Windows 7 update, Secure Boot and a suspect motherboard " data-hashtags="Windows,Secure Boot"><i class="fab fa-twitter fa-fw"></i></a><a href="javascript:void(0);" title="Share on Facebook" data-sharer="facebook" data-url="https://www.stevenmaude.co.uk/posts/the-case-of-a-windows-7-update-secure-boot-and-a-suspect-motherboard/" data-hashtag="Windows"><i class="fab fa-facebook-square fa-fw"></i></a><a href="javascript:void(0);" title="Share on Hacker News" data-sharer="hackernews" data-url="https://www.stevenmaude.co.uk/posts/the-case-of-a-windows-7-update-secure-boot-and-a-suspect-motherboard/" data-title="The case of a Windows 7 update, Secure Boot and a suspect motherboard "><i class="fab fa-hacker-news fa-fw"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw"></i>&nbsp;<a href="/tags/windows/">Windows</a>,&nbsp;<a href="/tags/secure-boot/">Secure Boot</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/posts/firefox-keyword-searches-and-how-to-fix-adding-them/" class="prev" rel="prev" title="Firefox keyword searches, and how to fix adding them"><i class="fas fa-angle-left fa-fw"></i>Firefox keyword searches, and how to fix adding them</a>
            <a href="/posts/managing-a-bitbucket-users-permissions-when-theyve-left-your-team/" class="next" rel="next" title="Managing a Bitbucket user&#39;s permissions when they&#39;ve left your team">Managing a Bitbucket user&#39;s permissions when they&#39;ve left your team<i class="fas fa-angle-right fa-fw"></i></a></div>
</div>
<div id="comments"></div></article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener noreferrer" title="Hugo 0.91.2">Hugo</a> | Theme - <a href="https://github.com/sunt-programator/CodeIT" target="_blank" rel="noopener noreferrer" title="CodeIT 0.2.10"><i class="fas fa-laptop-code fa-fw"></i> CodeIT</a>
                </div><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2013 - 2022</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/" target="_blank" rel="noopener noreferrer">Steven Maude</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw"></i>
            </a>
        </div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/smooth-scroll@16.1.3/dist/smooth-scroll.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/autocomplete.js@0.37.1/dist/autocomplete.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lunr@2.3.8/lunr.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lazysizes@5.2.2/lazysizes.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/clipboard@2.0.6/dist/clipboard.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/sharer.js@0.4.0/sharer.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":10},"comment":{},"search":{"highlightTag":"em","lunrIndexURL":"/index.json","maxResultLength":10,"noResultsFound":"No results found","snippetLength":30,"type":"lunr"}};</script><script type="text/javascript" src="/js/theme.min.47a1ff73dc443ed4a9f13e3134f6058e8c6d21248b35d03e7d64f56345190c3e.js" integrity="sha256-R6H/c9xEPtSp8T4xNPYFjoxtISSLNdA&#43;fWT1Y0UZDD4="></script></body>
</html>
